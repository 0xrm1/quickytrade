#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Get previous and current branch names
previous_head=$1
new_head=$2
is_branch_checkout=$3

# Only run on branch checkout (not file checkout)
if [ $is_branch_checkout -eq 1 ]; then
  # Check if package.json was changed
  if git diff --name-only $previous_head $new_head | grep --quiet "package.json"; then
    echo "📦 package.json changed. Running npm install..."
    npm install
  fi

  # Check if .env.example was changed
  if git diff --name-only $previous_head $new_head | grep --quiet ".env.example"; then
    echo "🔑 .env.example changed. Please update your .env file accordingly."
  fi

  # Check if docker-compose files were changed
  if git diff --name-only $previous_head $new_head | grep --quiet "docker-compose"; then
    echo "🐳 Docker configuration changed. You may need to rebuild containers:"
    echo "npm run build && npm start"
  fi
fi 